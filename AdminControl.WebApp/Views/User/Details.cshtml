@model UserDetailsViewModel
@{
    ViewData["Title"] = "Деталі користувача";
    var initials = $"{Model.User.FirstName.FirstOrDefault()}{Model.User.LastName.FirstOrDefault()}".ToUpper();
    var isAdmin = Model.User.RoleName.Equals("Admin", StringComparison.OrdinalIgnoreCase);
}

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="page-header">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a asp-controller="User" asp-action="Index">Користувачі</a></li>
                    <li class="breadcrumb-item active">@Model.User.FullName</li>
                </ol>
            </nav>
        </div>

        <!-- User Header Card -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="d-flex align-items-center gap-4">
                    <div class="avatar avatar-lg @(isAdmin ? "bg-danger-subtle text-danger" : "")">
                        @initials
                    </div>
                    <div class="flex-grow-1">
                        <h3 class="mb-1">@Model.User.FullName</h3>
                        <div class="d-flex align-items-center gap-3 text-muted">
                            <span>@@@Model.User.Login</span>
                            <span>•</span>
                            <span>@Model.User.Email</span>
                        </div>
                        <div class="mt-2">
                            @{
                                var badgeClass = Model.User.RoleName switch
                                {
                                    "Admin" => "bg-danger",
                                    "Manager" => "bg-primary",
                                    _ => "bg-secondary"
                                };
                            }
                            <span class="badge @badgeClass me-2">@Model.User.RoleName</span>
                            @if (Model.User.IsActive)
                            {
                                <span class="badge badge-status badge-active">
                                    <i class="bi bi-check-circle me-1"></i>Активний
                                </span>
                            }
                            else
                            {
                                <span class="badge badge-status badge-inactive">
                                    <i class="bi bi-x-circle me-1"></i>Неактивний
                                </span>
                            }
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        @if (Model.CanEdit)
                        {
                            <a asp-action="Edit" asp-route-id="@Model.User.UserID" class="btn btn-primary">
                                <i class="bi bi-pencil me-2"></i>Редагувати
                            </a>
                        }
                        @if (Model.CanDelete)
                        {
                            <a asp-action="Delete" asp-route-id="@Model.User.UserID" class="btn btn-outline-danger">
                                <i class="bi bi-trash me-2"></i>Видалити
                            </a>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- User Details -->
        <div class="row g-4">
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-header">
                        <i class="bi bi-person me-2"></i>Особиста інформація
                    </div>
                    <div class="card-body">
                        <dl class="row mb-0">
                            <dt class="col-sm-4 text-muted">Ім'я</dt>
                            <dd class="col-sm-8">@Model.User.FirstName</dd>

                            <dt class="col-sm-4 text-muted">Прізвище</dt>
                            <dd class="col-sm-8">@Model.User.LastName</dd>

                            <dt class="col-sm-4 text-muted">Стать</dt>
                            <dd class="col-sm-8">
                                @(Model.User.Gender switch
                                {
                                    "Male" => "Чоловік",
                                    "Female" => "Жінка",
                                    _ => "Не вказано"
                                })
                            </dd>

                            <dt class="col-sm-4 text-muted">Адреса</dt>
                            <dd class="col-sm-8">@(Model.User.Address ?? "Не вказано")</dd>
                        </dl>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-header">
                        <i class="bi bi-envelope me-2"></i>Контактна інформація
                    </div>
                    <div class="card-body">
                        <dl class="row mb-0">
                            <dt class="col-sm-4 text-muted">Email</dt>
                            <dd class="col-sm-8">
                                <a href="mailto:@Model.User.Email">@Model.User.Email</a>
                            </dd>

                            <dt class="col-sm-4 text-muted">Телефон</dt>
                            <dd class="col-sm-8">
                                @if (!string.IsNullOrEmpty(Model.User.PhoneNumber))
                                {
                                    <a href="tel:@Model.User.PhoneNumber">@Model.User.PhoneNumber</a>
                                }
                                else
                                {
                                    <span class="text-muted">Не вказано</span>
                                }
                            </dd>
                        </dl>
                    </div>
                </div>
            </div>

            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-shield me-2"></i>Інформація облікового запису
                    </div>
                    <div class="card-body">
                        <dl class="row mb-0">
                            <dt class="col-sm-2 text-muted">ID</dt>
                            <dd class="col-sm-4">@Model.User.UserID</dd>

                            <dt class="col-sm-2 text-muted">Логін</dt>
                            <dd class="col-sm-4"><code>@Model.User.Login</code></dd>

                            <dt class="col-sm-2 text-muted">Роль</dt>
                            <dd class="col-sm-4">
                                <span class="badge @badgeClass">@Model.User.RoleName</span>
                            </dd>

                            <dt class="col-sm-2 text-muted">Статус</dt>
                            <dd class="col-sm-4">
                                @if (Model.User.IsActive)
                                {
                                    <span class="text-success"><i class="bi bi-check-circle me-1"></i>Активний</span>
                                }
                                else
                                {
                                    <span class="text-danger"><i class="bi bi-x-circle me-1"></i>Неактивний</span>
                                }
                            </dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions Footer -->
        <div class="d-flex justify-content-between mt-4">
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Назад до списку
            </a>
            @if (Model.CanChangeStatus)
            {
                <form asp-action="ToggleStatus" asp-route-id="@Model.User.UserID" method="post">
                    @Html.AntiForgeryToken()
                    @if (Model.User.IsActive)
                    {
                        <button type="submit" class="btn btn-warning" 
                                onclick="return confirm('Деактивувати користувача @Model.User.FullName?')">
                            <i class="bi bi-pause-circle me-2"></i>Деактивувати
                        </button>
                    }
                    else
                    {
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-play-circle me-2"></i>Активувати
                        </button>
                    }
                </form>
            }
        </div>
    </div>
</div>
